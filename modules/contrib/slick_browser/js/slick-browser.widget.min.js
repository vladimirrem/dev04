!function(a,b){"use strict";function c(c,d){function l(){k&&(g.find(".slick-cloned").removeAttr("data-entity-id data-row-id data-drupal-selector"),g.on("setPosition",function(){g.find(".slick-cloned").removeAttr("data-entity-id data-row-id data-drupal-selector")}))}function m(c){c.preventDefault();var g=a(c.currentTarget),i=g.data("handled"),j=g.data("target"),k=e.siblings('input[type*=hidden][name*="[target_id]"]');switch("done"!==j&&e.data("deltas",""),e.toggleClass("sb--"+j),a.each(["caption","crop","sort","done"],function(a,b){"done"!==j&&j===b||e.removeClass("sb--"+b)}),a(".button--sb").removeClass("is-active"),a(".button--"+j,d)[e.hasClass("sb--"+j)?"addClass":"removeClass"]("is-active"),j){case"crop":!i&&h.length&&h[0].slick.refresh();break;case"remove":var m=g.data("entityId"),o=k.val(),p=e.data("removedId")||"";k.val(a.trim(o.replace(m,""))),e.data("removedId",p+" "+m),n(g),e.find('.sb__sortable [data-entity-id="'+m+'"]').remove();break;case"removeall":k.val(""),a(d).contents(':not(div[id*="ajax-wrapper"])').remove(),n(g);break;case"done":e.data("deltas")&&n()}g.data("handled",!i),b.slickBrowser.jump(f),l()}function n(c){a(".slick",d).each(function(){var f=a(".slick__slider",this),g=a(".slide",f),h=f.slick("getSlick"),i=0,j=!1;if(c)if("removeall"===c.data("target"))f.slick("removeSlide",null,null,!0),j=!0;else{var k=c.closest(".slide").data("slickIndex");f.slick("slickRemove",k),g.each(function(){a(this).attr("data-slick-index",i),i++}),1===g.length&&(a(d).empty(),j=!0)}else g.sort(function(b,c){return a(b).data("rowId")-a(c).data("rowId")}),f.empty(),g.clone().detach().appendTo(f),f.slick(h.options),j=!0;j&&(b.attachBehaviors(e[0]),a(".media--player",g).length&&b.attachBehaviors(a(".media--player",g)[0]))})}function o(){a("*[draggable!=true]",h).unbind("dragstart"),h.on("draggable mouseenter mousedown",".focal-point-indicator",function(a){a.stopPropagation()})}function p(c){var d=a(c.delegateTarget),e=a(".sb.sb--error",d).attr("id"),f=a(".sb .slick__slider",d),g=a(".form-text.required",f);g.length&&(a(".slick-cloned .form-text",f).removeAttr("required aria-required"),g.each(function(){var b=a(this);if(b.removeClass("error").removeAttr("tabindex"),!this.value){var c=parseInt(b.closest(".slide").data("slickIndex"));b.addClass("error"),b.closest(".sb--widget").addClass("sb--error sb--caption"),f.slick("slickGoTo",c,!0),f.slick("slickPause")}}),b.slickBrowser.jump(e))}var e=a(d),f=e.attr("id"),g=a(".slick__slider",d),h=a(".slick--browser .slick__slider",d),i=a(".sb__header",d),j=e.data("end")?e.data("end"):0,k=h.hasClass("slick-initialized");l(),e.hasClass("sb--1")&&a(".slick__slide",d).addClass("slick-current slick-active"),k&&!i.find(".slick__arrow").length&&h.siblings(".slick__arrow").appendTo(i),j>1&&a(".focal-point-indicator",h).length&&o(),e.data("deltas",""),e.off("click.btnSb").on("click.btnSb",".button--sb",m),a("form").on("click.btnDo",".publish .button",p)}function d(b,c){function g(b){var j,c=a(b.target),d=a(".sb__sortitem",c),e=c.closest(".sb--widget"),f=c.closest(".sb--eb").length,g=[],h=[],i=0,k=d.length;a(".slick",e).each(function(){var b=a(".slick__slider",this);b.hasClass("slick-initialized")&&b.slick("unslick")}),e.find(".slick__slide.slick-cloned").remove();for(var l=0;l<k;l++)j=d[l],i=a(j).data("rowId"),h[l]=i,a(".sb__weight",j).val(l),a(".sb__weight option",j).removeAttr("selected"),a('.sb__weight option[value="'+l+'"]',j).prop("selected",!0).siblings("option").prop("selected",!1),e.find(".slick__slide.slide--"+i).attr("data-slick-index",l).attr("data-row-id",l),a(j).attr("data-row-id",l),f&&(g[l]=a(j).attr("data-entity-id"));e.data("deltas",h),f&&e.siblings('input[type*=hidden][name*="[target_id]"]').val(g.join(" "))}var d=a(".sb__sortitem:first",c),e=d.height(),f=d.width();a(c).sortable({placeholder:"sb__placeholder",items:".sb__sortitem",stop:g,cancel:"a, input, .button",over:function(a,b){b.placeholder.addClass("grid").css({height:0,width:0})},change:function(a,b){b.placeholder.css({height:e,width:f})}})}b.behaviors.slickBrowserWidget={attach:function(e){a(".sb--widget",e).once("sbWidget").each(c),a(".sb__sortable",e).once("sbSortable").each(d),a(".js-form-managed-file .js-form-submit:not(.button--sb)",e).on("mousedown.sbAjax",b.slickBrowser.loading)},detach:function(c,d,e){"unload"===e&&(a(".js-form-managed-file .js-form-submit:not(.button--sb)",c).off(".sbAjax"),b.slickBrowser.loaded())}}}(jQuery,Drupal);
